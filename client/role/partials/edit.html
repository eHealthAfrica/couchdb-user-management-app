
<div class="row list-header">
    <div class = "col-lg-12">
        <div class = ' page-header'>

            <div class="ma-list-button">
                <a class="btn btn-default pull-right " ng-class="size ? 'btn-' + size : ''" ui-sref="list(stateParams)" href="#!/users/list">
                    <span class="glyphicon glyphicon-list" aria-hidden="true"></span>&nbsp;<span class="hidden-xs ng-scope" translate="LIST">List</span>
                </a>
            </div>
            <h1>
                <span class="">Assign Roles&nbsp;<i>{{user.name}}</i></span>
            </h1>
        </div>
    </div>
</div>
<div class = "grid">
    <div class="row" id="edit-view">
        <form class="col-lg-12 form-horizontal ng-pristine "
              name="updateUserRoleForm"
              ng-submit="submitUpdateUserRoleForm()"
              novalidate>


            <div>
                <div id="username" class="form-field form-group has-feedback">
                    <label for="name" class="col-sm-2 control-label">Username</label>
                    <div ng-class="" class="ng-admin-field-name ng-admin-type-string col-sm-10 col-md-8 col-lg-7">
                        <input type="text" ng-model="user.name" id="name" class="form-control"  disabled>
                    </div>
                </div>

                <div id="usertype" class="form-field form-group has-feedback">
                    <label for="type" class="col-sm-2 control-label">User Type</label>
                    <div class="ng-admin-field-name ng-admin-type-string col-sm-10 col-md-8 col-lg-7"
                         ng-init="updateUserRoleForm.type=getUserType()"
                        >
                        <select  ng-model="updateUserRoleForm.type" id="type"  class="form-control"
                                 ng-required="true"
                                 ng-options = "type as type for type in userTypes"
                        ></select>
                      </div>
                </div>

                <div  class="form-field form-group has-feedback" ng-if="updateUserRoleForm.type === 'Dashboard'">
                    <label for="accessLevel" class="col-sm-2 control-label">Access Level</label>
                    <div class="ng-admin-field-name ng-admin-type-string col-sm-10 col-md-8 col-lg-7"
                        ng-init="updateUserRoleForm.access.level =  user.lomis_stock.dashboard.access.level"
                        >
                        <select  ng-model="updateUserRoleForm.access.level" id="accessLevel" class="form-control"
                                 ng-required="true"
                                 ng-options ="adminLevel._id as adminLevel.name for adminLevel in adminLevels"
                        ></select>
                      </div>
                </div>




                <!-- ng repeat block -->
                <div ng-repeat = "adminLevel in adminLevels | getWithAncestors : updateUserRoleForm.access.level"
                     class="form-field form-group has-feedback"
                     ng-if="updateUserRoleForm.type == 'Dashboard' && updateUserRoleForm.access.level">
                    <label for="name" class="col-sm-2 control-label">{{adminLevel.name}}</label>
                    <div class="ng-admin-field-name ng-admin-type-string col-sm-10 col-md-8 col-lg-7"
                         ng-init="updateUserRoleForm.locations[$index] =  getLocation($index)"
                    >
                        <select ng-if="$index === 0"
                                ng-model="updateUserRoleForm.locations[$index]"  class="form-control"
                                ng-options="location._id as location.name for location in locations | filter :{adminLevel: (  adminLevel._id)}"
                                ng-required="true"
                                 <!--ng-options ="location.name as location.name for location in locationsInAdminLevel[$index]"-->
                        ></select>

                        <select ng-if="$index > 0"
                                ng-model="updateUserRoleForm.locations[$index]"  class="form-control"
                                ng-options="location._id as location.name for location in locations | getChildrenLocation : updateUserRoleForm.locations[$index - 1] : $index - 1"
                                ng-required="true"
                        <!--ng-options ="location.name as location.name for location in locationsInAdminLevel[$index]"-->
                        ></select>

                    </div>
                </div>



                <div  class="form-field form-group has-feedback" ng-if="updateUserRoleForm.type === 'Mobile'">
                    <label for="facility" class="col-sm-2 control-label">FACILIY</label>

                    <div ng-class="" class="ng-admin-field-name ng-admin-type-string col-sm-10 col-md-8 col-lg-7">
                        <!--select ng-if="updateUserRoleForm.type === 'Dashboard'"
                                ng-model="updateUserRoleForm.facility" id="facility" class="form-control"
                                ng-options ="facility._id as facility.name for facility in facilities | getFacilitiesInLocation : updateUserRoleForm.locations"
                        ></select-->
                        <select
                                ng-model="updateUserRoleForm.facility" id="facility" class="form-control"
                                ng-options ="facility._id as facility.name for facility in facilities"
                                ng-required="true"
                        ></select>
                    </div>
                </div>

                <div id="usertype" class="form-field form-group has-feedback" ng-if="updateUserRoleForm.type === 'Mobile'">
                    <label for="name" class="col-sm-2 control-label">PROGRAM</label>

                    <div ng-class="" class="ng-admin-field-name ng-admin-type-string col-sm-10 col-md-8 col-lg-7">
                        <select  ng-model="updateUserRoleForm.program" id="nalme" name="name" class="form-control"
                                 ng-required="true"
                                 ng-options ="program._id as program.name for program in programs | getProgramsInFacility : facilityPrograms : updateUserRoleForm.facility"
                        ></select>
                    </div>
                </div-->


            </div>

            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" class="btn btn-primary">
                        <span class=""></span>&nbsp;
                        <span class="hidden-xs ng-scope" translate="ASSIGN ROLE">Assign Role</span>
                    </button>
                </div>
            </div>

        </form>
    </div>
    <div class="row">
        <div class="col-lg-12">
        </div>
    </div>
</div>
